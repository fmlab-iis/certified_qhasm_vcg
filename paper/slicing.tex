


\begin{algorithm}
  \begin{algorithmic}[1]
    \Function{VarsInE}{$e$}
    \Match{$e$}
      \Case{$V$}
        \Return $\{ e \}$
      \EndCase
      \Case{$Z$}
        \Return $\emptyset$
      \EndCase
      \Case{$-e'$}
        \Return \Call{VarsInE}{$e'$}
      \EndCase
      \Case{$e' + e''$}
        \Return \Call{VarsInE}{$e'$} $\cup$ \Call{VarsInE}{$e''$}
      \EndCase
      \Case{$e' - e''$}
        \Return \Call{VarsInE}{$e'$} $\cup$ \Call{VarsInE}{$e''$}
      \EndCase
      \Case{$e' \times e''$}
        \Return \Call{VarsInE}{$e'$} $\cup$ \Call{VarsInE}{$e''$}
      \EndCase
      \Case{$\dslcode{Pow}(e', \uscore)$}
        \Return \Call{VarsInE}{$e'$}
      \EndCase
    \EndMatch
    \EndFunction
  \end{algorithmic}
  \caption{Variables Occurred in an Expression}
\end{algorithm}

\begin{algorithm}
\begin{algorithmic}[1]
  \Function{VarsInQ}{$q$}
  \Match{$q$}
    \Case{$\top$}
      $\emptyset$
    \EndCase
    \Case{$e' = e''$}
      \Return \Call{VarsInE}{$e'$} $\cup$ \Call{VarsInE}{$e''$}
    \EndCase
    \Case{$e' \equiv e'' \mod \uscore$}
      \Return \Call{VarsInE}{$e'$} $\cup$ \Call{VarsInE}{$e''$}
    \EndCase
    \Case{$q' \wedge q''$}
      \Return \Call{VarsInQ}{$q'$} $\cup$ \Call{VarsInQ}{$q''$}
    \EndCase
  \EndMatch
  \EndFunction
\end{algorithmic}
\caption{Variables Occurred in Predicates}
\end{algorithm}

\begin{algorithm}
  \begin{algorithmic}[1]
    \Function{SliceStatement}{$\mathit{vars}$, $s$}
    \Match{$s$}
      \Case{$v \leftarrow e$}
        \IfThenElse{$v \in \mathit{vars}$}
          {\Return \Call{VarsInE}{$e$} $\cup$ $(\mathit{vars} \setminus \{
            v \})$, $s$}
          {\Return $\mathit{vars}$}
      \EndCase
      \Case{$v_h, v_l \leftarrow \dslcode{Split} (e, \uscore)$}
        \IfThenElse{$v_h \in \mathit{vars}$ \textbf{or} $v_l \in \mathit{vars}$}
          {\Return \Call{VarsInE}{$e$} $\cup$ $(\mathit{vars} \setminus \{
            v_h, v_h \})$, $s$}
          {\Return $\mathit{vars}$}
      \EndCase
    \EndMatch
    \EndFunction
  \end{algorithmic}
  \caption{Slicing a Statement}
\end{algorithm}

\begin{algorithm}
  \begin{algorithmic}[1]
    \Function{SliceProgram}{$\mathit{vars}$, $pp$}
    \Match{$p$}
      \Case{$\epsilon$}
        \Return $\epsilon$
      \EndCase
      \Case{$pp; s;$}
        \Match{\Call{SliceStatement}{$\mathit{vars}$, $s$}}
          \Case{$\mathit{vars}'$}
            \Return \Call{SliceProgram}{$\mathit{vars}'$, $pp$}
          \EndCase
          \Case{$\mathit{vars}'$, $s'$}
            \Return \Call{SliceProgram}{$\mathit{vars}'$, $pp$}$\ s';$
          \EndCase
        \EndMatch
      \EndCase
    \EndMatch
    \EndFunction
  \end{algorithmic}
  \caption{Slicing a Program}
\end{algorithm}

\begin{theorem}
  For every $q, q' \in Q$ and $p \in P$,
  \begin{center}
  $\models \hoaretriple{q}{p}{q'}$ if and only if
  $\models \hoaretriple{q}{\textsc{SliceProgram}(\textsc{VarsInQ}(q'), p)}
  {q'}$.
  \end{center}

\end{theorem}